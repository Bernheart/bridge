// ignore_for_file: constant_identifier_names

import 'package:bridge_game/bridge_game.dart';

enum BoardVulnerability {
  none({
    PairDirection.NS: Vulnerability.notVulnerable,
    PairDirection.EW: Vulnerability.notVulnerable
  }),
  NS({
    PairDirection.NS: Vulnerability.vulnerable,
    PairDirection.EW: Vulnerability.notVulnerable
  }),
  EW({
    PairDirection.NS: Vulnerability.notVulnerable,
    PairDirection.EW: Vulnerability.vulnerable
  }),
  both({
    PairDirection.NS: Vulnerability.vulnerable,
    PairDirection.EW: Vulnerability.vulnerable
  });

  final Map<PairDirection, Vulnerability> pairDirectionsMap;

  const BoardVulnerability(this.pairDirectionsMap);

  @override
  String toString({FileEncoding encoding = FileEncoding.pbn}) {
    return encoding.boardVulnerabilityNames[this]!;
  }

  factory BoardVulnerability.fromFixedBoardNumber(int boardNumber) {
    boardNumber = (boardNumber - 1) % 4 + 1;
    switch (boardNumber) {
      case 1:
        return BoardVulnerability.none;
      case 2:
        return BoardVulnerability.NS;
      case 3:
        return BoardVulnerability.EW;
      default:
        return BoardVulnerability.both;
    }
  }

  factory BoardVulnerability.fromBoardNumber(int boardNumber) {
    int sequenceShift = ((boardNumber - 1) ~/ 4);
    int boardIndex = (boardNumber + sequenceShift - 1) % 4 + 1;
    return BoardVulnerability.fromFixedBoardNumber(boardIndex);
  }
}
